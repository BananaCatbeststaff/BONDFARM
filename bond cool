-- Variáveis herdadas de getgenv
local enabled = getgenv().enabled
local autoexecute = getgenv().autoexecute
local firsttime = getgenv().firsttime

-- Interface
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.Name = "AutoExecUI"
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Botão "LIGAR"
local ligarBtn = Instance.new("TextButton")
ligarBtn.Size = UDim2.new(0, 200, 0, 50)
ligarBtn.AnchorPoint = Vector2.new(0.5, 0.5)
ligarBtn.Position = UDim2.new(0.5, 0, 0.5, 0)
ligarBtn.BackgroundColor3 = Color3.fromRGB(50, 200, 50)
ligarBtn.Text = "LIGAR"
ligarBtn.Font = Enum.Font.GothamBold
ligarBtn.TextSize = 24
ligarBtn.TextColor3 = Color3.new(1, 1, 1)
ligarBtn.Parent = ScreenGui

-- Texto "RODANDO!"
local rodandoLabel = Instance.new("TextLabel")
rodandoLabel.Size = UDim2.new(1, 0, 1, 0)
rodandoLabel.Position = UDim2.new(0, 0, 0, 0)
rodandoLabel.BackgroundColor3 = Color3.new(0, 0, 1)
rodandoLabel.BackgroundTransparency = 0.5
rodandoLabel.TextColor3 = Color3.new(1, 1, 1)
rodandoLabel.TextScaled = true
rodandoLabel.Visible = false
rodandoLabel.Text = "RODANDO!"
rodandoLabel.Font = Enum.Font.GothamBold
rodandoLabel.ZIndex = 2
rodandoLabel.Parent = ScreenGui

-- Créditos
local creditLabel = Instance.new("TextLabel")
creditLabel.Size = UDim2.new(1, 0, 0, 25)
creditLabel.Position = UDim2.new(0, 0, 1, -25)
creditLabel.BackgroundTransparency = 1
creditLabel.TextColor3 = Color3.fromRGB(130, 90, 180) -- Roxo mais escuro
creditLabel.TextScaled = true
creditLabel.Text = "by Unk Community: https://discord.gg/CYW4xx9qYc"
creditLabel.Font = Enum.Font.Gotham
creditLabel.ZIndex = 3
creditLabel.Parent = ScreenGui

-- Webhook
local function sendToWebhook(bondValue)
	local HttpService = game:GetService("HttpService")
	local player = game:GetService("Players").LocalPlayer
	local placeId = game.PlaceId
	local webhookUrl = "https://discord.com/api/webhooks/1370107337695821874/xiQdGN0yA66GkHJBbekalCpomsctQTqv49s7bTeBiLGk6howZyNcrsiQaH9ngFMxJ659"
	local avatarUrl = "https://i.imgur.com/ABekA1W.png"

	local statusText = "status: rodando"
	if placeId == 116495829188952 then
		statusText = "status: novo servidor"
	end

	local content = "**Logger de Bonds via Réplica**\nJogador: `" .. player.Name .. "`\nQuantidade de Bonds: `" .. tostring(bondValue) .. "`\n" .. statusText

	local data = {
		["content"] = content,
		["username"] = "Bond Logger",
		["avatar_url"] = avatarUrl
	}

	local headers = { ["Content-Type"] = "application/json" }
	local body = HttpService:JSONEncode(data)
	local http_request = http_request or request or (syn and syn.request) or (http and http.request)

	if http_request then
		http_request({
			Url = webhookUrl,
			Method = "POST",
			Headers = headers,
			Body = body
		})
	end
end

-- Bond Logger
local function iniciarReplicaWebhook()
	local success, result = pcall(function()
		local ReplicatedStorage = game:GetService("ReplicatedStorage")
		local PlayerDataController = require(ReplicatedStorage:WaitForChild("Client"):WaitForChild("Controllers"):WaitForChild("PlayerDataController"))
		local replica = PlayerDataController.getReplica()
		if not replica then warn("Rélica de dados do jogador não encontrada.") return end

		local bonds = replica.Data.bonds
		sendToWebhook(bonds)

		replica:OnSet({ "bonds" }, function(newValue)
			sendToWebhook(newValue)
		end)
	end)
	if not success then warn("Erro ao injetar o script:", result) end
end

-- Execução principal
local function executarScript()
	if not enabled then return end

	rodandoLabel.Visible = true
	ligarBtn.Visible = false

	local cframes = {
		CFrame.new(38.2541, 9.08605, 100.5861),
		CFrame.new(37.3862, 9.06972, 115.8381),
		CFrame.new(38.2564, 9.11877, 130.3275),
		CFrame.new(38.2567, 9.09839, 144.9002)
	}

	local player = game.Players.LocalPlayer
	local character = player.Character or player.CharacterAdded:Wait()
	local hrp = character:WaitForChild("HumanoidRootPart")

	for _, cframe in ipairs(cframes) do
		hrp.CFrame = cframe
		task.wait(2)

		if game.PlaceId ~= 70876832253163 then
			local args = {
				[1] = {
					["trainId"] = "default",
					["maxMembers"] = 1,
					["gameMode"] = "Normal"
				}
			}
			game:GetService("ReplicatedStorage").Shared.Network.RemoteEvent.CreateParty:FireServer(unpack(args))
			task.wait(2)
		end

		loadstring(game:HttpGet("https://raw.githubusercontent.com/thiennrb7/Script/refs/heads/main/autobond"))()
		task.wait(2)

		iniciarReplicaWebhook()
	end
end

-- Execução automática
if autoexecute or firsttime then
	executarScript()
end
